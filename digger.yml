version: 1
collect_usage_data: false
auto_merge: false
projects:
  - name: dev
    dir: infra/live/dev
    terragrunt: true
    workflow: terragrunt-runall
    include_patterns:
      - "infra/live/dev/**"
  - name: staging
    dir: infra/live/staging
    terragrunt: true
    workflow: terragrunt-runall
    include_patterns:
      - "infra/live/staging/**"
  - name: prod
    dir: infra/live/prod
    terragrunt: true
    workflow: terragrunt-runall
    include_patterns:
      - "infra/live/prod/**"
workflows:
  terragrunt-runall:
    plan:
      steps:
        - run: terragrunt run-all plan -no-color -parallelism 4
    apply:
      steps:
        - run: terragrunt run-all apply -auto-approve -no-color -parallelism 2